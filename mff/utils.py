import numpy as np
import pandas as pd
from itertools import product


def multiindex_from_multiindex_product(idx_left, idx_right):
    concat_list = []
    left_is_multiindex = isinstance(idx_left, pd.MultiIndex)
    right_is_multiindex = isinstance(idx_right, pd.MultiIndex)
    for a, b in product(idx_left, idx_right):
        if left_is_multiindex and right_is_multiindex:
            item = (*a, *b)
        elif left_is_multiindex and not right_is_multiindex:
            item = (*a, b)
        elif not left_is_multiindex and right_is_multiindex:
            item = (a, *b)
        else:
            item = (a, b)
        concat_list.append(item)
    return pd.MultiIndex.from_tuples(concat_list, names=list(idx_left.names) + list(idx_right.names))


def load_synthetic_data():
    d = np.array([[4.19, 4.51, -0.32, 0.94, 6.21],
                  [2.69, 2.38, 0.3, 1.01, 7.87],
                  [-9.67, -10.22, 0.55, 0.98, 6.94],
                  [-8.8, -8.99, 0.19, 0.9, 4.44],
                  [-9.57, -10.26, 0.69, 0.86, 4.08],
                  [-4.47, -4.12, -0.34, 0.73, -0.11],
                  [-3.08, -2.27, -0.81, 0.65, 1.17],
                  [-7.98, -7.65, -0.33, 0.62, 3.25],
                  [-7.6, -6.86, -0.74, 0.67, 4.51],
                  [-4.89, -1.53, -3.36, 0.82, 5.5],
                  [-5.85, -2.31, -3.54, 0.94, 5.28],
                  [-7.29, -4.11, -3.17, 0.97, 6.62],
                  [-7.03, -3.45, -3.57, 1.02, 8.49],
                  [-4.8, -0.61, -4.19, 1.22, 10.83],
                  [-6.36, -2.31, -4.05, 1.42, 5.57],
                  [-3.44, -1.05, -2.4, 1.39, -5.46],
                  [-4.63, -1.06, -3.57, 1.33, 6.72],
                  [-4.87, -0.43, -4.45, 1.39, 2.67],
                  [0.93, 3.97, -3.05, 1.29, 1.32],
                  [1.85, 4.55, -2.7, 1.33, 0.63],
                  [1.14, 3.84, -2.7, 1.33, 2.7],
                  [-2.08, 1.16, -3.24, 1.11, 5.17],
                  [-2.73, 2.01, -4.75, 1.11, 1.94],
                  [-1.91, 1.75, -3.66, 1.13, 2.94],
                  [-2.2, 0.77, -2.96, 1.18, 4.03],
                  [-3.35, 0.09, -3.44, 1.12, 2.51],
                  [0.55, 2.11, -1.55, 1.14, -3.34],
                  [-2.46, 0.03, -2.49, 1.18, 4.79],
                  [-2.73, -0.27, np.nan, 1.05, 4.51],
                  [-2.98, -0.55, np.nan, 1.1, 4.26],
                  [np.nan, np.nan, np.nan, 1.1, 4.04],
                  [np.nan, np.nan, np.nan, 1.1, 3.86],
                  [np.nan, np.nan, np.nan, 1.1, 3.72],
                  [-.3, np.nan, np.nan, 1.1, 3.60],
                  [np.nan, np.nan, np.nan, 1.1, 3.49],
                  [np.nan, np.nan, np.nan, 1.1, 3.39],
                  [np.nan, np.nan, np.nan, 1.1, 3.30]])
    idx = pd.Index(range(1994, 2031), dtype='int64', name='year')
    col = pd.MultiIndex.from_tuples([('CA', 'A', 1),
                                     ('TA', 'A', 1),
                                     ('IA', 'A', 1),
                                     ('FX', 'A', 1),
                                     ('GDP', 'A', 1)],
                                    names=['variable', 'freq', 'subperiod'])
    data = pd.DataFrame(d, index=idx, columns=col)
    constraints = ['CA? - TA? - IA?']
    return data, constraints


def load_forecast_data():
    d = np.array([[4.19, 4.51, -0.32, 0.94, 6.21],
     [2.69, 2.38, 0.3, 1.01, 7.87],
     [-9.67, -10.22, 0.55, 0.98, 6.94],
     [-8.8, -8.99, 0.19, 0.9, 4.44],
     [-9.57, -10.26, 0.69, 0.86, 4.08],
     [-4.47, -4.12, -0.34, 0.73, -0.11],
     [-3.08, -2.27, -0.81, 0.65, 1.17],
     [-7.98, -7.65, -0.33, 0.62, 3.25],
     [-7.6, -6.86, -0.74, 0.67, 4.51],
     [-4.89, -1.53, -3.36, 0.82, 5.5],
     [-5.85, -2.31, -3.54, 0.94, 5.28],
     [-7.29, -4.11, -3.17, 0.97, 6.62],
     [-7.03, -3.45, -3.57, 1.02, 8.49],
     [-4.8, -0.61, -4.19, 1.22, 10.83],
     [-6.36, -2.31, -4.05, 1.42, 5.57],
     [-3.44, -1.05, -2.4, 1.39, -5.46],
     [-4.63, -1.06, -3.57, 1.33, 6.72],
     [-4.87, -0.43, -4.45, 1.39, 2.67],
     [0.93, 3.97, -3.05, 1.29, 1.32],
     [1.85, 4.55, -2.7, 1.33, 0.63],
     [1.14, 3.84, -2.7, 1.33, 2.7],
     [-2.08, 1.16, -3.24, 1.11, 5.17],
     [-2.73, 2.01, -4.75, 1.11, 1.94],
     [-1.91, 1.75, -3.66, 1.13, 2.94],
     [-2.2, 0.77, -2.96, 1.18, 4.03],
     [-3.35, 0.09, -3.44, 1.12, 2.51],
     [0.55, 2.11, -1.55, 1.14, -3.34],
     [-2.46, 0.03, -2.49, 1.18, 4.79],
     [-2.73, -0.27, -2.64, 1.05, 4.51],
     [-2.98, -0.55, -2.21, 1.1, 4.26],
     [-3.7, -1.43, -2.32, 1.1, 4.04],
     [-3.7, -1.3, -2.27, 1.1, 3.86],
     [-3.7, -1.22, -2.27, 1.1, 3.72],
     [-3.7, -1.43, -2.83, 1.1, 3.6],
     [-3.7, -1.43, -2.27, 1.1, 3.49],
     [-4.1, -1.81, -2.27, 1.1, 3.39],
     [-3.98, -1.43, -2.76, 1.1, 3.3]])
    idx = pd.Index(range(1994, 2031), dtype='int64', name='year')
    col = pd.MultiIndex.from_tuples([('CA', 'A', 1),
                                     ('TA', 'A', 1),
                                     ('IA', 'A', 1),
                                     ('FX', 'A', 1),
                                     ('GDP', 'A', 1)],
                                    names=['variable', 'freq', 'subperiod'])
    data = pd.DataFrame(d, index=idx, columns=col)

    W = {"('CA', 'A', 1, 2024)": {"('CA', 'A', 1, 2024)": 6.2735655625, "('CA', 'A', 1, 2025)": 1.72184758,
                              "('CA', 'A', 1, 2026)": -0.8873357325, "('CA', 'A', 1, 2027)": 1.0842528432,
                              "('CA', 'A', 1, 2028)": 2.6073958256, "('CA', 'A', 1, 2029)": -6.8894752118,
                              "('CA', 'A', 1, 2030)": 6.2606131776, "('TA', 'A', 1, 2024)": 5.277312683,
                              "('TA', 'A', 1, 2025)": -0.6767134196, "('TA', 'A', 1, 2026)": 2.9182644611,
                              "('TA', 'A', 1, 2027)": 2.4182199343, "('TA', 'A', 1, 2028)": -1.0067781289,
                              "('TA', 'A', 1, 2029)": -3.0202222031, "('TA', 'A', 1, 2030)": 4.3664260747,
                              "('IA', 'A', 1, 2022)": 0.253184437, "('IA', 'A', 1, 2023)": -1.6426489197,
                              "('IA', 'A', 1, 2024)": 0.696502648, "('IA', 'A', 1, 2025)": 3.8432729595,
                              "('IA', 'A', 1, 2026)": -2.4608406162, "('IA', 'A', 1, 2027)": -3.5277917557,
                              "('IA', 'A', 1, 2028)": 0.5582109473, "('IA', 'A', 1, 2029)": -1.026495481,
                              "('IA', 'A', 1, 2030)": 0.3464231873},
     "('CA', 'A', 1, 2025)": {"('CA', 'A', 1, 2024)": 1.72184758, "('CA', 'A', 1, 2025)": 0.4725795976,
                              "('CA', 'A', 1, 2026)": -0.2435388406, "('CA', 'A', 1, 2027)": 0.2975848607,
                              "('CA', 'A', 1, 2028)": 0.7156278432, "('CA', 'A', 1, 2029)": -1.8908906112,
                              "('CA', 'A', 1, 2030)": 1.7182926586, "('TA', 'A', 1, 2024)": 1.4484152563,
                              "('TA', 'A', 1, 2025)": -0.1857312803, "('TA', 'A', 1, 2026)": 0.8009490855,
                              "('TA', 'A', 1, 2027)": 0.663706484, "('TA', 'A', 1, 2028)": -0.2763210917,
                              "('TA', 'A', 1, 2029)": -0.828932485, "('TA', 'A', 1, 2030)": 1.1984126244,
                              "('IA', 'A', 1, 2022)": 0.0694891933, "('IA', 'A', 1, 2023)": -0.450842673,
                              "('IA', 'A', 1, 2024)": 0.191162647, "('IA', 'A', 1, 2025)": 1.0548276222,
                              "('IA', 'A', 1, 2026)": -0.6754041888, "('IA', 'A', 1, 2027)": -0.9682404108,
                              "('IA', 'A', 1, 2028)": 0.1532070015, "('IA', 'A', 1, 2029)": -0.2817327311,
                              "('IA', 'A', 1, 2030)": 0.0950795717},
     "('CA', 'A', 1, 2026)": {"('CA', 'A', 1, 2024)": -0.8873357325, "('CA', 'A', 1, 2025)": -0.2435388406,
                              "('CA', 'A', 1, 2026)": 0.1255051365, "('CA', 'A', 1, 2027)": -0.1533571748,
                              "('CA', 'A', 1, 2028)": -0.3687911542, "('CA', 'A', 1, 2029)": 0.9744502504,
                              "('CA', 'A', 1, 2030)": -0.8855037417, "('TA', 'A', 1, 2024)": -0.7464253092,
                              "('TA', 'A', 1, 2025)": 0.0957146286, "('TA', 'A', 1, 2026)": -0.4127605438,
                              "('TA', 'A', 1, 2027)": -0.3420340372, "('TA', 'A', 1, 2028)": 0.1423991189,
                              "('TA', 'A', 1, 2029)": 0.4271814894, "('TA', 'A', 1, 2030)": -0.617589127,
                              "('IA', 'A', 1, 2022)": -0.0358105125, "('IA', 'A', 1, 2023)": 0.232336949,
                              "('IA', 'A', 1, 2024)": -0.0985136253, "('IA', 'A', 1, 2025)": -0.543594132,
                              "('IA', 'A', 1, 2026)": 0.3480623242, "('IA', 'A', 1, 2027)": 0.4989723388,
                              "('IA', 'A', 1, 2028)": -0.0789535894, "('IA', 'A', 1, 2029)": 0.1451879494,
                              "('IA', 'A', 1, 2030)": -0.0489982403},
     "('CA', 'A', 1, 2027)": {"('CA', 'A', 1, 2024)": 1.0842528432, "('CA', 'A', 1, 2025)": 0.2975848607,
                              "('CA', 'A', 1, 2026)": -0.1533571748, "('CA', 'A', 1, 2027)": 0.1873901239,
                              "('CA', 'A', 1, 2028)": 0.4506331063, "('CA', 'A', 1, 2029)": -1.1906997722,
                              "('CA', 'A', 1, 2030)": 1.082014298, "('TA', 'A', 1, 2024)": 0.9120716479,
                              "('TA', 'A', 1, 2025)": -0.1169555721, "('TA', 'A', 1, 2026)": 0.5043601613,
                              "('TA', 'A', 1, 2027)": 0.417938063, "('TA', 'A', 1, 2028)": -0.1740002616,
                              "('TA', 'A', 1, 2029)": -0.5219813961, "('TA', 'A', 1, 2030)": 0.7546442033,
                              "('IA', 'A', 1, 2022)": 0.0437575639, "('IA', 'A', 1, 2023)": -0.2838970509,
                              "('IA', 'A', 1, 2024)": 0.1203757208, "('IA', 'A', 1, 2025)": 0.6642282753,
                              "('IA', 'A', 1, 2026)": -0.4253041445, "('IA', 'A', 1, 2027)": -0.6097040356,
                              "('IA', 'A', 1, 2028)": 0.0964749313, "('IA', 'A', 1, 2029)": -0.177407988,
                              "('IA', 'A', 1, 2030)": 0.0598719057},
     "('CA', 'A', 1, 2028)": {"('CA', 'A', 1, 2024)": 2.6073958256, "('CA', 'A', 1, 2025)": 0.7156278432,
                              "('CA', 'A', 1, 2026)": -0.3687911542, "('CA', 'A', 1, 2027)": 0.4506331063,
                              "('CA', 'A', 1, 2028)": 1.0836760888, "('CA', 'A', 1, 2029)": -2.8633778876,
                              "('CA', 'A', 1, 2030)": 2.6020126039, "('TA', 'A', 1, 2024)": 2.1933369347,
                              "('TA', 'A', 1, 2025)": -0.2812530973, "('TA', 'A', 1, 2026)": 1.2128781469,
                              "('TA', 'A', 1, 2027)": 1.0050515133, "('TA', 'A', 1, 2028)": -0.4184333557,
                              "('TA', 'A', 1, 2029)": -1.2552534418, "('TA', 'A', 1, 2030)": 1.8147576536,
                              "('IA', 'A', 1, 2022)": 0.1052275676, "('IA', 'A', 1, 2023)": -0.6827115926,
                              "('IA', 'A', 1, 2024)": 0.2894778223, "('IA', 'A', 1, 2025)": 1.597326715,
                              "('IA', 'A', 1, 2026)": -1.0227653615, "('IA', 'A', 1, 2027)": -1.4662075985,
                              "('IA', 'A', 1, 2028)": 0.2320015435, "('IA', 'A', 1, 2029)": -0.4266282078,
                              "('IA', 'A', 1, 2030)": 0.1439791078},
     "('CA', 'A', 1, 2029)": {"('CA', 'A', 1, 2024)": -6.8894752118, "('CA', 'A', 1, 2025)": -1.8908906112,
                              "('CA', 'A', 1, 2026)": 0.9744502504, "('CA', 'A', 1, 2027)": -1.1906997722,
                              "('CA', 'A', 1, 2028)": -2.8633778876, "('CA', 'A', 1, 2029)": 7.5658520217,
                              "('CA', 'A', 1, 2030)": -6.8752512217, "('TA', 'A', 1, 2024)": -5.7954148326,
                              "('TA', 'A', 1, 2025)": 0.7431500131, "('TA', 'A', 1, 2026)": -3.2047661679,
                              "('TA', 'A', 1, 2027)": -2.6556295823, "('TA', 'A', 1, 2028)": 1.1056189489,
                              "('TA', 'A', 1, 2029)": 3.3167336494, "('TA', 'A', 1, 2030)": -4.7951015903,
                              "('IA', 'A', 1, 2022)": -0.278040914, "('IA', 'A', 1, 2023)": 1.8039165927,
                              "('IA', 'A', 1, 2024)": -0.7648820564, "('IA', 'A', 1, 2025)": -4.2205877221,
                              "('IA', 'A', 1, 2026)": 2.7024345655, "('IA', 'A', 1, 2027)": 3.8741340329,
                              "('IA', 'A', 1, 2028)": -0.6130135161, "('IA', 'A', 1, 2029)": 1.1272720594,
                              "('IA', 'A', 1, 2030)": -0.3804334135},
     "('CA', 'A', 1, 2030)": {"('CA', 'A', 1, 2024)": 6.2606131776, "('CA', 'A', 1, 2025)": 1.7182926586,
                              "('CA', 'A', 1, 2026)": -0.8855037417, "('CA', 'A', 1, 2027)": 1.082014298,
                              "('CA', 'A', 1, 2028)": 2.6020126039, "('CA', 'A', 1, 2029)": -6.8752512217,
                              "('CA', 'A', 1, 2030)": 6.2476875342, "('TA', 'A', 1, 2024)": 5.2664171588,
                              "('TA', 'A', 1, 2025)": -0.6753162791, "('TA', 'A', 1, 2026)": 2.912239421,
                              "('TA', 'A', 1, 2027)": 2.4132272846, "('TA', 'A', 1, 2028)": -1.0046995378,
                              "('TA', 'A', 1, 2029)": -3.0139866613, "('TA', 'A', 1, 2030)": 4.3574111643,
                              "('IA', 'A', 1, 2022)": 0.2526617132, "('IA', 'A', 1, 2023)": -1.6392575116,
                              "('IA', 'A', 1, 2024)": 0.6950646507, "('IA', 'A', 1, 2025)": 3.8353381495,
                              "('IA', 'A', 1, 2026)": -2.4557599719, "('IA', 'A', 1, 2027)": -3.5205082872,
                              "('IA', 'A', 1, 2028)": 0.5570584666, "('IA', 'A', 1, 2029)": -1.0243761815,
                              "('IA', 'A', 1, 2030)": 0.345707963},
     "('TA', 'A', 1, 2024)": {"('CA', 'A', 1, 2024)": 5.277312683, "('CA', 'A', 1, 2025)": 1.4484152563,
                              "('CA', 'A', 1, 2026)": -0.7464253092, "('CA', 'A', 1, 2027)": 0.9120716479,
                              "('CA', 'A', 1, 2028)": 2.1933369347, "('CA', 'A', 1, 2029)": -5.7954148326,
                              "('CA', 'A', 1, 2030)": 5.2664171588, "('TA', 'A', 1, 2024)": 4.4392664548,
                              "('TA', 'A', 1, 2025)": -0.5692501778, "('TA', 'A', 1, 2026)": 2.4548391022,
                              "('TA', 'A', 1, 2027)": 2.0342024966, "('TA', 'A', 1, 2028)": -0.84690005,
                              "('TA', 'A', 1, 2029)": -2.5406057814, "('TA', 'A', 1, 2030)": 3.6730301889,
                              "('IA', 'A', 1, 2022)": 0.2129783179, "('IA', 'A', 1, 2023)": -1.3817934779,
                              "('IA', 'A', 1, 2024)": 0.5858968431, "('IA', 'A', 1, 2025)": 3.232954678,
                              "('IA', 'A', 1, 2026)": -2.0700549417, "('IA', 'A', 1, 2027)": -2.9675724259,
                              "('IA', 'A', 1, 2028)": 0.4695660996, "('IA', 'A', 1, 2029)": -0.8634862531,
                              "('IA', 'A', 1, 2030)": 0.2914105961},
     "('TA', 'A', 1, 2025)": {"('CA', 'A', 1, 2024)": -0.6767134196, "('CA', 'A', 1, 2025)": -0.1857312803,
                              "('CA', 'A', 1, 2026)": 0.0957146286, "('CA', 'A', 1, 2027)": -0.1169555721,
                              "('CA', 'A', 1, 2028)": -0.2812530973, "('CA', 'A', 1, 2029)": 0.7431500131,
                              "('CA', 'A', 1, 2030)": -0.6753162791, "('TA', 'A', 1, 2024)": -0.5692501778,
                              "('TA', 'A', 1, 2025)": 0.0729953402, "('TA', 'A', 1, 2026)": -0.3147856993,
                              "('TA', 'A', 1, 2027)": -0.2608471793, "('TA', 'A', 1, 2028)": 0.1085985734,
                              "('TA', 'A', 1, 2029)": 0.3257836193, "('TA', 'A', 1, 2030)": -0.4709951767,
                              "('IA', 'A', 1, 2022)": -0.0273103556, "('IA', 'A', 1, 2023)": 0.177188324,
                              "('IA', 'A', 1, 2024)": -0.0751299535, "('IA', 'A', 1, 2025)": -0.4145639925,
                              "('IA', 'A', 1, 2026)": 0.2654445629, "('IA', 'A', 1, 2027)": 0.3805338446,
                              "('IA', 'A', 1, 2028)": -0.0602127825, "('IA', 'A', 1, 2029)": 0.1107254336,
                              "('IA', 'A', 1, 2030)": -0.0373677803},
     "('TA', 'A', 1, 2026)": {"('CA', 'A', 1, 2024)": 2.9182644611, "('CA', 'A', 1, 2025)": 0.8009490855,
                              "('CA', 'A', 1, 2026)": -0.4127605438, "('CA', 'A', 1, 2027)": 0.5043601613,
                              "('CA', 'A', 1, 2028)": 1.2128781469, "('CA', 'A', 1, 2029)": -3.2047661679,
                              "('CA', 'A', 1, 2030)": 2.912239421, "('TA', 'A', 1, 2024)": 2.4548391022,
                              "('TA', 'A', 1, 2025)": -0.3147856993, "('TA', 'A', 1, 2026)": 1.357484413,
                              "('TA', 'A', 1, 2027)": 1.1248795001, "('TA', 'A', 1, 2028)": -0.4683213724,
                              "('TA', 'A', 1, 2029)": -1.4049119328, "('TA', 'A', 1, 2030)": 2.0311234352,
                              "('IA', 'A', 1, 2022)": 0.1177733997, "('IA', 'A', 1, 2023)": -0.7641083713,
                              "('IA', 'A', 1, 2024)": 0.3239910231, "('IA', 'A', 1, 2025)": 1.7877691371,
                              "('IA', 'A', 1, 2026)": -1.1447052945, "('IA', 'A', 1, 2027)": -1.64101725,
                              "('IA', 'A', 1, 2028)": 0.2596620938, "('IA', 'A', 1, 2029)": -0.4774932615,
                              "('IA', 'A', 1, 2030)": 0.1611451201},
     "('TA', 'A', 1, 2027)": {"('CA', 'A', 1, 2024)": 2.4182199343, "('CA', 'A', 1, 2025)": 0.663706484,
                              "('CA', 'A', 1, 2026)": -0.3420340372, "('CA', 'A', 1, 2027)": 0.417938063,
                              "('CA', 'A', 1, 2028)": 1.0050515133, "('CA', 'A', 1, 2029)": -2.6556295823,
                              "('CA', 'A', 1, 2030)": 2.4132272846, "('TA', 'A', 1, 2024)": 2.0342024966,
                              "('TA', 'A', 1, 2025)": -0.2608471793, "('TA', 'A', 1, 2026)": 1.1248795001,
                              "('TA', 'A', 1, 2027)": 0.9321314319, "('TA', 'A', 1, 2028)": -0.3880745194,
                              "('TA', 'A', 1, 2029)": -1.1641803158, "('TA', 'A', 1, 2030)": 1.6830904962,
                              "('IA', 'A', 1, 2022)": 0.0975929313, "('IA', 'A', 1, 2023)": -0.6331784251,
                              "('IA', 'A', 1, 2024)": 0.2684751711, "('IA', 'A', 1, 2025)": 1.4814349497,
                              "('IA', 'A', 1, 2026)": -0.948560077, "('IA', 'A', 1, 2027)": -1.359828994,
                              "('IA', 'A', 1, 2028)": 0.2151690019, "('IA', 'A', 1, 2029)": -0.3956748057,
                              "('IA', 'A', 1, 2030)": 0.1335329087},
     "('TA', 'A', 1, 2028)": {"('CA', 'A', 1, 2024)": -1.0067781289, "('CA', 'A', 1, 2025)": -0.2763210917,
                              "('CA', 'A', 1, 2026)": 0.1423991189, "('CA', 'A', 1, 2027)": -0.1740002616,
                              "('CA', 'A', 1, 2028)": -0.4184333557, "('CA', 'A', 1, 2029)": 1.1056189489,
                              "('CA', 'A', 1, 2030)": -1.0046995378, "('TA', 'A', 1, 2024)": -0.84690005,
                              "('TA', 'A', 1, 2025)": 0.1085985734, "('TA', 'A', 1, 2026)": -0.4683213724,
                              "('TA', 'A', 1, 2027)": -0.3880745194, "('TA', 'A', 1, 2028)": 0.1615671648,
                              "('TA', 'A', 1, 2029)": 0.4846834911, "('TA', 'A', 1, 2030)": -0.7007215004,
                              "('IA', 'A', 1, 2022)": -0.0406308902, "('IA', 'A', 1, 2023)": 0.263611337,
                              "('IA', 'A', 1, 2024)": -0.1117743372, "('IA', 'A', 1, 2025)": -0.6167661947,
                              "('IA', 'A', 1, 2026)": 0.3949142615, "('IA', 'A', 1, 2027)": 0.5661379558,
                              "('IA', 'A', 1, 2028)": -0.089581366, "('IA', 'A', 1, 2029)": 0.1647313939,
                              "('IA', 'A', 1, 2030)": -0.0555937903},
     "('TA', 'A', 1, 2029)": {"('CA', 'A', 1, 2024)": -3.0202222031, "('CA', 'A', 1, 2025)": -0.828932485,
                              "('CA', 'A', 1, 2026)": 0.4271814894, "('CA', 'A', 1, 2027)": -0.5219813961,
                              "('CA', 'A', 1, 2028)": -1.2552534418, "('CA', 'A', 1, 2029)": 3.3167336494,
                              "('CA', 'A', 1, 2030)": -3.0139866613, "('TA', 'A', 1, 2024)": -2.5406057814,
                              "('TA', 'A', 1, 2025)": 0.3257836193, "('TA', 'A', 1, 2026)": -1.4049119328,
                              "('TA', 'A', 1, 2027)": -1.1641803158, "('TA', 'A', 1, 2028)": 0.4846834911,
                              "('TA', 'A', 1, 2029)": 1.4539964659, "('TA', 'A', 1, 2030)": -2.1020864208,
                              "('IA', 'A', 1, 2022)": -0.1218881433, "('IA', 'A', 1, 2023)": 0.7908046373,
                              "('IA', 'A', 1, 2024)": -0.3353105568, "('IA', 'A', 1, 2025)": -1.8502298588,
                              "('IA', 'A', 1, 2026)": 1.1846987799, "('IA', 'A', 1, 2027)": 1.6983507835,
                              "('IA', 'A', 1, 2028)": -0.2687341162, "('IA', 'A', 1, 2029)": 0.4941758259,
                              "('IA', 'A', 1, 2030)": -0.1667751762},
     "('TA', 'A', 1, 2030)": {"('CA', 'A', 1, 2024)": 4.3664260747, "('CA', 'A', 1, 2025)": 1.1984126244,
                              "('CA', 'A', 1, 2026)": -0.617589127, "('CA', 'A', 1, 2027)": 0.7546442033,
                              "('CA', 'A', 1, 2028)": 1.8147576536, "('CA', 'A', 1, 2029)": -4.7951015903,
                              "('CA', 'A', 1, 2030)": 4.3574111643, "('TA', 'A', 1, 2024)": 3.6730301889,
                              "('TA', 'A', 1, 2025)": -0.4709951767, "('TA', 'A', 1, 2026)": 2.0311234352,
                              "('TA', 'A', 1, 2027)": 1.6830904962, "('TA', 'A', 1, 2028)": -0.7007215004,
                              "('TA', 'A', 1, 2029)": -2.1020864208, "('TA', 'A', 1, 2030)": 3.0390495605,
                              "('IA', 'A', 1, 2022)": 0.1762173546, "('IA', 'A', 1, 2023)": -1.1432900482,
                              "('IA', 'A', 1, 2024)": 0.4847685567, "('IA', 'A', 1, 2025)": 2.6749329541,
                              "('IA', 'A', 1, 2026)": -1.7127546568, "('IA', 'A', 1, 2027)": -2.455356807,
                              "('IA', 'A', 1, 2028)": 0.3885169942, "('IA', 'A', 1, 2029)": -0.7144448542,
                              "('IA', 'A', 1, 2030)": 0.2411118881},
     "('IA', 'A', 1, 2022)": {"('CA', 'A', 1, 2024)": 0.253184437, "('CA', 'A', 1, 2025)": 0.0694891933,
                              "('CA', 'A', 1, 2026)": -0.0358105125, "('CA', 'A', 1, 2027)": 0.0437575639,
                              "('CA', 'A', 1, 2028)": 0.1052275676, "('CA', 'A', 1, 2029)": -0.278040914,
                              "('CA', 'A', 1, 2030)": 0.2526617132, "('TA', 'A', 1, 2024)": 0.2129783179,
                              "('TA', 'A', 1, 2025)": -0.0273103556, "('TA', 'A', 1, 2026)": 0.1177733997,
                              "('TA', 'A', 1, 2027)": 0.0975929313, "('TA', 'A', 1, 2028)": -0.0406308902,
                              "('TA', 'A', 1, 2029)": -0.1218881433, "('TA', 'A', 1, 2030)": 0.1762173546,
                              "('IA', 'A', 1, 2022)": 0.0102178512, "('IA', 'A', 1, 2023)": -0.0662929458,
                              "('IA', 'A', 1, 2024)": 0.0281089962, "('IA', 'A', 1, 2025)": 0.155104285,
                              "('IA', 'A', 1, 2026)": -0.0993129887, "('IA', 'A', 1, 2027)": -0.1423723018,
                              "('IA', 'A', 1, 2028)": 0.0225279106, "('IA', 'A', 1, 2029)": -0.0414266302,
                              "('IA', 'A', 1, 2030)": 0.0139807194},
     "('IA', 'A', 1, 2023)": {"('CA', 'A', 1, 2024)": -1.6426489197, "('CA', 'A', 1, 2025)": -0.450842673,
                              "('CA', 'A', 1, 2026)": 0.232336949, "('CA', 'A', 1, 2027)": -0.2838970509,
                              "('CA', 'A', 1, 2028)": -0.6827115926, "('CA', 'A', 1, 2029)": 1.8039165927,
                              "('CA', 'A', 1, 2030)": -1.6392575116, "('TA', 'A', 1, 2024)": -1.3817934779,
                              "('TA', 'A', 1, 2025)": 0.177188324, "('TA', 'A', 1, 2026)": -0.7641083713,
                              "('TA', 'A', 1, 2027)": -0.6331784251, "('TA', 'A', 1, 2028)": 0.263611337,
                              "('TA', 'A', 1, 2029)": 0.7908046373, "('TA', 'A', 1, 2030)": -1.1432900482,
                              "('IA', 'A', 1, 2022)": -0.0662929458, "('IA', 'A', 1, 2023)": 0.430105567,
                              "('IA', 'A', 1, 2024)": -0.1823698678, "('IA', 'A', 1, 2025)": -1.0063094284,
                              "('IA', 'A', 1, 2026)": 0.6443380785, "('IA', 'A', 1, 2027)": 0.9237049105,
                              "('IA', 'A', 1, 2028)": -0.1461600425, "('IA', 'A', 1, 2029)": 0.268774061,
                              "('IA', 'A', 1, 2030)": -0.0907062609},
     "('IA', 'A', 1, 2024)": {"('CA', 'A', 1, 2024)": 0.696502648, "('CA', 'A', 1, 2025)": 0.191162647,
                              "('CA', 'A', 1, 2026)": -0.0985136253, "('CA', 'A', 1, 2027)": 0.1203757208,
                              "('CA', 'A', 1, 2028)": 0.2894778223, "('CA', 'A', 1, 2029)": -0.7648820564,
                              "('CA', 'A', 1, 2030)": 0.6950646507, "('TA', 'A', 1, 2024)": 0.5858968431,
                              "('TA', 'A', 1, 2025)": -0.0751299535, "('TA', 'A', 1, 2026)": 0.3239910231,
                              "('TA', 'A', 1, 2027)": 0.2684751711, "('TA', 'A', 1, 2028)": -0.1117743372,
                              "('TA', 'A', 1, 2029)": -0.3353105568, "('TA', 'A', 1, 2030)": 0.4847685567,
                              "('IA', 'A', 1, 2022)": 0.0281089962, "('IA', 'A', 1, 2023)": -0.1823698678,
                              "('IA', 'A', 1, 2024)": 0.0773269896, "('IA', 'A', 1, 2025)": 0.4266871473,
                              "('IA', 'A', 1, 2026)": -0.2732069966, "('IA', 'A', 1, 2027)": -0.3916618508,
                              "('IA', 'A', 1, 2028)": 0.0619735937, "('IA', 'A', 1, 2029)": -0.1139633935,
                              "('IA', 'A', 1, 2030)": 0.0384605317},
     "('IA', 'A', 1, 2025)": {"('CA', 'A', 1, 2024)": 3.8432729595, "('CA', 'A', 1, 2025)": 1.0548276222,
                              "('CA', 'A', 1, 2026)": -0.543594132, "('CA', 'A', 1, 2027)": 0.6642282753,
                              "('CA', 'A', 1, 2028)": 1.597326715, "('CA', 'A', 1, 2029)": -4.2205877221,
                              "('CA', 'A', 1, 2030)": 3.8353381495, "('TA', 'A', 1, 2024)": 3.232954678,
                              "('TA', 'A', 1, 2025)": -0.4145639925, "('TA', 'A', 1, 2026)": 1.7877691371,
                              "('TA', 'A', 1, 2027)": 1.4814349497, "('TA', 'A', 1, 2028)": -0.6167661947,
                              "('TA', 'A', 1, 2029)": -1.8502298588, "('TA', 'A', 1, 2030)": 2.6749329541,
                              "('IA', 'A', 1, 2022)": 0.155104285, "('IA', 'A', 1, 2023)": -1.0063094284,
                              "('IA', 'A', 1, 2024)": 0.4266871473, "('IA', 'A', 1, 2025)": 2.3544421261,
                              "('IA', 'A', 1, 2026)": -1.5075449684, "('IA', 'A', 1, 2027)": -2.1611739809,
                              "('IA', 'A', 1, 2028)": 0.3419677404, "('IA', 'A', 1, 2029)": -0.6288453171,
                              "('IA', 'A', 1, 2030)": 0.2122236319},
     "('IA', 'A', 1, 2026)": {"('CA', 'A', 1, 2024)": -2.4608406162, "('CA', 'A', 1, 2025)": -0.6754041888,
                              "('CA', 'A', 1, 2026)": 0.3480623242, "('CA', 'A', 1, 2027)": -0.4253041445,
                              "('CA', 'A', 1, 2028)": -1.0227653615, "('CA', 'A', 1, 2029)": 2.7024345655,
                              "('CA', 'A', 1, 2030)": -2.4557599719, "('TA', 'A', 1, 2024)": -2.0700549417,
                              "('TA', 'A', 1, 2025)": 0.2654445629, "('TA', 'A', 1, 2026)": -1.1447052945,
                              "('TA', 'A', 1, 2027)": -0.948560077, "('TA', 'A', 1, 2028)": 0.3949142615,
                              "('TA', 'A', 1, 2029)": 1.1846987799, "('TA', 'A', 1, 2030)": -1.7127546568,
                              "('IA', 'A', 1, 2022)": -0.0993129887, "('IA', 'A', 1, 2023)": 0.6443380785,
                              "('IA', 'A', 1, 2024)": -0.2732069966, "('IA', 'A', 1, 2025)": -1.5075449684,
                              "('IA', 'A', 1, 2026)": 0.965278274, "('IA', 'A', 1, 2027)": 1.3837957301,
                              "('IA', 'A', 1, 2028)": -0.218961316, "('IA', 'A', 1, 2029)": 0.4026485014,
                              "('IA', 'A', 1, 2030)": -0.1358864016},
     "('IA', 'A', 1, 2027)": {"('CA', 'A', 1, 2024)": -3.5277917557, "('CA', 'A', 1, 2025)": -0.9682404108,
                              "('CA', 'A', 1, 2026)": 0.4989723388, "('CA', 'A', 1, 2027)": -0.6097040356,
                              "('CA', 'A', 1, 2028)": -1.4662075985, "('CA', 'A', 1, 2029)": 3.8741340329,
                              "('CA', 'A', 1, 2030)": -3.5205082872, "('TA', 'A', 1, 2024)": -2.9675724259,
                              "('TA', 'A', 1, 2025)": 0.3805338446, "('TA', 'A', 1, 2026)": -1.64101725,
                              "('TA', 'A', 1, 2027)": -1.359828994, "('TA', 'A', 1, 2028)": 0.5661379558,
                              "('TA', 'A', 1, 2029)": 1.6983507835, "('TA', 'A', 1, 2030)": -2.455356807,
                              "('IA', 'A', 1, 2022)": -0.1423723018, "('IA', 'A', 1, 2023)": 0.9237049105,
                              "('IA', 'A', 1, 2024)": -0.3916618508, "('IA', 'A', 1, 2025)": -2.1611739809,
                              "('IA', 'A', 1, 2026)": 1.3837957301, "('IA', 'A', 1, 2027)": 1.9837705604,
                              "('IA', 'A', 1, 2028)": -0.3138967718, "('IA', 'A', 1, 2029)": 0.5772255441,
                              "('IA', 'A', 1, 2030)": -0.1948029158},
     "('IA', 'A', 1, 2028)": {"('CA', 'A', 1, 2024)": 0.5582109473, "('CA', 'A', 1, 2025)": 0.1532070015,
                              "('CA', 'A', 1, 2026)": -0.0789535894, "('CA', 'A', 1, 2027)": 0.0964749313,
                              "('CA', 'A', 1, 2028)": 0.2320015435, "('CA', 'A', 1, 2029)": -0.6130135161,
                              "('CA', 'A', 1, 2030)": 0.5570584666, "('TA', 'A', 1, 2024)": 0.4695660996,
                              "('TA', 'A', 1, 2025)": -0.0602127825, "('TA', 'A', 1, 2026)": 0.2596620938,
                              "('TA', 'A', 1, 2027)": 0.2151690019, "('TA', 'A', 1, 2028)": -0.089581366,
                              "('TA', 'A', 1, 2029)": -0.2687341162, "('TA', 'A', 1, 2030)": 0.3885169942,
                              "('IA', 'A', 1, 2022)": 0.0225279106, "('IA', 'A', 1, 2023)": -0.1461600425,
                              "('IA', 'A', 1, 2024)": 0.0619735937, "('IA', 'A', 1, 2025)": 0.3419677404,
                              "('IA', 'A', 1, 2026)": -0.218961316, "('IA', 'A', 1, 2027)": -0.3138967718,
                              "('IA', 'A', 1, 2028)": 0.0496686388, "('IA', 'A', 1, 2029)": -0.0913357817,
                              "('IA', 'A', 1, 2030)": 0.0308241324},
     "('IA', 'A', 1, 2029)": {"('CA', 'A', 1, 2024)": -1.026495481, "('CA', 'A', 1, 2025)": -0.2817327311,
                              "('CA', 'A', 1, 2026)": 0.1451879494, "('CA', 'A', 1, 2027)": -0.177407988,
                              "('CA', 'A', 1, 2028)": -0.4266282078, "('CA', 'A', 1, 2029)": 1.1272720594,
                              "('CA', 'A', 1, 2030)": -1.0243761815, "('TA', 'A', 1, 2024)": -0.8634862531,
                              "('TA', 'A', 1, 2025)": 0.1107254336, "('TA', 'A', 1, 2026)": -0.4774932615,
                              "('TA', 'A', 1, 2027)": -0.3956748057, "('TA', 'A', 1, 2028)": 0.1647313939,
                              "('TA', 'A', 1, 2029)": 0.4941758259, "('TA', 'A', 1, 2030)": -0.7144448542,
                              "('IA', 'A', 1, 2022)": -0.0414266302, "('IA', 'A', 1, 2023)": 0.268774061,
                              "('IA', 'A', 1, 2024)": -0.1139633935, "('IA', 'A', 1, 2025)": -0.6288453171,
                              "('IA', 'A', 1, 2026)": 0.4026485014, "('IA', 'A', 1, 2027)": 0.5772255441,
                              "('IA', 'A', 1, 2028)": -0.0913357817, "('IA', 'A', 1, 2029)": 0.1679575932,
                              "('IA', 'A', 1, 2030)": -0.0566825727},
     "('IA', 'A', 1, 2030)": {"('CA', 'A', 1, 2024)": 0.3464231873, "('CA', 'A', 1, 2025)": 0.0950795717,
                              "('CA', 'A', 1, 2026)": -0.0489982403, "('CA', 'A', 1, 2027)": 0.0598719057,
                              "('CA', 'A', 1, 2028)": 0.1439791078, "('CA', 'A', 1, 2029)": -0.3804334135,
                              "('CA', 'A', 1, 2030)": 0.345707963, "('TA', 'A', 1, 2024)": 0.2914105961,
                              "('TA', 'A', 1, 2025)": -0.0373677803, "('TA', 'A', 1, 2026)": 0.1611451201,
                              "('TA', 'A', 1, 2027)": 0.1335329087, "('TA', 'A', 1, 2028)": -0.0555937903,
                              "('TA', 'A', 1, 2029)": -0.1667751762, "('TA', 'A', 1, 2030)": 0.2411118881,
                              "('IA', 'A', 1, 2022)": 0.0139807194, "('IA', 'A', 1, 2023)": -0.0907062609,
                              "('IA', 'A', 1, 2024)": 0.0384605317, "('IA', 'A', 1, 2025)": 0.2122236319,
                              "('IA', 'A', 1, 2026)": -0.1358864016, "('IA', 'A', 1, 2027)": -0.1948029158,
                              "('IA', 'A', 1, 2028)": 0.0308241324, "('IA', 'A', 1, 2029)": -0.0566825727,
                              "('IA', 'A', 1, 2030)": 0.0191293171}}

    W = pd.DataFrame.from_dict(W)
    idx = pd.MultiIndex.from_tuples([('CA', 'A', 1, 2024),
            ('CA', 'A', 1, 2025),
            ('CA', 'A', 1, 2026),
            ('CA', 'A', 1, 2027),
            ('CA', 'A', 1, 2028),
            ('CA', 'A', 1, 2029),
            ('CA', 'A', 1, 2030),
            ('TA', 'A', 1, 2024),
            ('TA', 'A', 1, 2025),
            ('TA', 'A', 1, 2026),
            ('TA', 'A', 1, 2027),
            ('TA', 'A', 1, 2028),
            ('TA', 'A', 1, 2029),
            ('TA', 'A', 1, 2030),
            ('IA', 'A', 1, 2022),
            ('IA', 'A', 1, 2023),
            ('IA', 'A', 1, 2024),
            ('IA', 'A', 1, 2025),
            ('IA', 'A', 1, 2026),
            ('IA', 'A', 1, 2027),
            ('IA', 'A', 1, 2028),
            ('IA', 'A', 1, 2029),
            ('IA', 'A', 1, 2030)],
           names=['variable', 'freq', 'subperiod', 'year'])
    W.index = idx
    W.columns = idx
    return data, W
